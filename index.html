<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cubos 3D de Secretarias</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
            font-family: Arial, sans-serif;
        }
        .container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 30px;
            padding: 30px;
            max-width: 1300px;
        }
        .cube-container {
            width: 200px;
            height: 200px;
            perspective: 600px;
            will-change: transform;
        }
        .cube {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
        }
        .cube-face {
            position: absolute;
            width: 200px;
            height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            font-size: 16px;
            color: #333;
            padding: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .cube-face span {
            margin: 5px 0;
        }
        .name {
            font-weight: bold;
            font-size: 20px;
        }
        /* Animação de três pontinhos */
        .loading::after {
            content: '...';
            display: inline-block;
            width: 20px;
            text-align: left;
            animation: dots 1.5s infinite;
        }
        @keyframes dots {
            0% { content: '...'; }
            33% { content: '..'; }
            66% { content: '.'; }
        }
        /* Posicionamento das faces */
        .front {
            transform: translateZ(100px);
        }
        .back {
            transform: translateZ(-100px) rotateY(180deg);
        }
        .left {
            transform: translateX(-100px) rotateY(-90deg);
        }
        .right {
            transform: translateX(100px) rotateY(90deg);
        }
        .top {
            transform: translateY(-100px) rotateX(90deg);
        }
        .bottom {
            transform: translateY(100px) rotateX(-90deg);
        }
        /* Cores para as faces frontais */
        .color-1 .front { background-color: #D4F4DD; } /* Menta Suave */
        .color-2 .front { background-color: #D6E6F2; } /* Azul Claro */
        .color-3 .front { background-color: #E6E6FA; } /* Lavanda Suave */
        .color-4 .front { background-color: #FFE8D6; } /* Pêssego Claro */
        .color-5 .front { background-color: #F5F5DC; } /* Creme Suave */
        /* Cores mais escuras para outras faces */
        .color-1 .back, .color-1 .left, .color-1 .right, .color-1 .top, .color-1 .bottom { background-color: #A8C7B0; }
        .color-2 .back, .color-2 .left, .color-2 .right, .color-2 .top, .color-2 .bottom { background-color: #A9C4D8; }
        .color-3 .back, .color-3 .left, .color-3 .right, .color-3 .top, .color-3 .bottom { background-color: #C5C5E0; }
        .color-4 .back, .color-4 .left, .color-4 .right, .color-4 .top, .color-4 .bottom { background-color: #E6C7A8; }
        .color-5 .back, .color-5 .left, .color-5 .right, .color-5 .top, .color-5 .bottom { background-color: #D8D8B0; }
    </style>
</head>
<body>
    <div class="container">
        <div class="cube-container color-1" id="sedes-cube">
            <div class="cube">
                <div class="cube-face front">
                    <span class="name">SEDES</span>
                    <span id="sedes-desktop">Desktop: Carregando...</span>
                    <span id="sedes-notebook">Notebook: Carregando...</span>
                    <span id="sedes-monitor">Monitor: Carregando...</span>
                </div>
                <div class="cube-face back"></div>
                <div class="cube-face left"></div>
                <div class="cube-face right"></div>
                <div class="cube-face top"></div>
                <div class="cube-face bottom"></div>
            </div>
        </div>
        <div class="cube-container color-2" id="sesau-cube">
            <div class="cube">
                <div class="cube-face front">
                    <span class="name">SESAU</span>
                    <span id="sesau-desktop">Desktop: Carregando...</span>
                    <span id="sesau-notebook">Notebook: Carregando...</span>
                    <span id="sesau-monitor">Monitor: Carregando...</span>
                </div>
                <div class="cube-face back"></div>
                <div class="cube-face left"></div>
                <div class="cube-face right"></div>
                <div class="cube-face top"></div>
                <div class="cube-face bottom"></div>
            </div>
        </div>
        <div class="cube-container color-3" id="sefaz-cube">
            <div class="cube">
                <div class="cube-face front">
                    <span class="name">SEFAZ</span>
                    <span id="sefaz-desktop">Desktop: Carregando...</span>
                    <span id="sefaz-notebook">Notebook: Carregando...</span>
                    <span id="sefaz-monitor">Monitor: Carregando...</span>
                </div>
                <div class="cube-face back"></div>
                <div class="cube-face left"></div>
                <div class="cube-face right"></div>
                <div class="cube-face top"></div>
                <div class="cube-face bottom"></div>
            </div>
        </div>
        <div class="cube-container color-4" id="seduc-cube">
            <div class="cube">
                <div class="cube-face front">
                    <span class="name">SEDUC</span>
                    <span id="seduc-desktop">Desktop: Carregando...</span>
                    <span id="seduc-notebook">Notebook: Carregando...</span>
                    <span id="seduc-monitor">Monitor: Carregando...</span>
                </div>
                <div class="cube-face back"></div>
                <div class="cube-face left"></div>
                <div class="cube-face right"></div>
                <div class="cube-face top"></div>
                <div class="cube-face bottom"></div>
            </div>
        </div>
        <div class="cube-container color-5" id="seo-cube">
            <div class="cube">
                <div class="cube-face front">
                    <span class="name">SEO</span>
                    <span id="seo-desktop">Desktop: Carregando...</span>
                    <span id="seo-notebook">Notebook: Carregando...</span>
                    <span id="seo-monitor">Monitor: Carregando...</span>
                </div>
                <div class="cube-face back"></div>
                <div class="cube-face left"></div>
                <div class="cube-face right"></div>
                <div class="cube-face top"></div>
                <div class="cube-face bottom"></div>
            </div>
        </div>
        <div class="cube-container color-1" id="sajur-cube">
            <div class="cube">
                <div class="cube-face front">
                    <span class="name">SAJUR</span>
                    <span id="sajur-desktop">Desktop: Carregando...</span>
                    <span id="sajur-notebook">Notebook: Carregando...</span>
                    <span id="sajur-monitor">Monitor: Carregando...</span>
                </div>
                <div class="cube-face back"></div>
                <div class="cube-face left"></div>
                <div class="cube-face right"></div>
                <div class="cube-face top"></div>
                <div class="cube-face bottom"></div>
            </div>
        </div>
        <div class="cube-container color-2" id="secad-cube">
            <div class="cube">
                <div class="cube-face front">
                    <span class="name">SECAD</span>
                    <span id="secad-desktop">Desktop: Carregando...</span>
                    <span id="secad-notebook">Notebook: Carregando...</span>
                    <span id="secad-monitor">Monitor: Carregando...</span>
                </div>
                <div class="cube-face back"></div>
                <div class="cube-face left"></div>
                <div class="cube-face right"></div>
                <div class="cube-face top"></div>
                <div class="cube-face bottom"></div>
            </div>
        </div>
        <div class="cube-container color-3" id="segur-cube">
            <div class="cube">
                <div class="cube-face front">
                    <span class="name">SEGUR</span>
                    <span id="segur-desktop">Desktop: Carregando...</span>
                    <span id="segur-notebook">Notebook: Carregando...</span>
                    <span id="segur-monitor">Monitor: Carregando...</span>
                </div>
                <div class="cube-face back"></div>
                <div class="cube-face left"></div>
                <div class="cube-face right"></div>
                <div class="cube-face top"></div>
                <div class="cube-face bottom"></div>
            </div>
        </div>
        <div class="cube-container color-4" id="setur-cube">
            <div class="cube">
                <div class="cube-face front">
                    <span class="name">SETUR</span>
                    <span id="setur-desktop">Desktop: Carregando...</span>
                    <span id="setur-notebook">Notebook: Carregando...</span>
                    <span id="setur-monitor">Monitor: Carregando...</span>
                </div>
                <div class="cube-face back"></div>
                <div class="cube-face left"></div>
                <div class="cube-face right"></div>
                <div class="cube-face top"></div>
                <div class="cube-face bottom"></div>
            </div>
        </div>
        <div class="cube-container color-5" id="sesep-cube">
            <div class="cube">
                <div class="cube-face front">
                    <span class="name">SESEP</span>
                    <span id="sesep-desktop">Desktop: Carregando...</span>
                    <span id="sesep-notebook">Notebook: Carregando...</span>
                    <span id="sesep-monitor">Monitor: Carregando...</span>
                </div>
                <div class="cube-face back"></div>
                <div class="cube-face left"></div>
                <div class="cube-face right"></div>
                <div class="cube-face top"></div>
                <div class="cube-face bottom"></div>
            </div>
        </div>
        <div class="cube-container color-1" id="semam-cube">
            <div class="cube">
                <div class="cube-face front">
                    <span class="name">SEMAM</span>
                    <span id="semam-desktop">Desktop: Carregando...</span>
                    <span id="semam-notebook">Notebook: Carregando...</span>
                    <span id="semam-monitor">Monitor: Carregando...</span>
                </div>
                <div class="cube-face back"></div>
                <div class="cube-face left"></div>
                <div class="cube-face right"></div>
                <div class="cube-face top"></div>
                <div class="cube-face bottom"></div>
            </div>
        </div>
        <div class="cube-container color-2" id="seurb-cube">
            <div class="cube">
                <div class="cube-face front">
                    <span class="name">SEURB</span>
                    <span id="seurb-desktop">Desktop: Carregando...</span>
                    <span id="seurb-notebook">Notebook: Carregando...</span>
                    <span id="seurb-monitor">Monitor: Carregando...</span>
                </div>
                <div class="cube-face back"></div>
                <div class="cube-face left"></div>
                <div class="cube-face right"></div>
                <div class="cube-face top"></div>
                <div class="cube-face bottom"></div>
            </div>
        </div>
        <div class="cube-container color-3" id="sepedi-cube">
            <div class="cube">
                <div class="cube-face front">
                    <span class="name">SEPEDI</span>
                    <span id="sepedi-desktop">Desktop: Carregando...</span>
                    <span id="sepedi-notebook">Notebook: Carregando...</span>
                    <span id="sepedi-monitor">Monitor: Carregando...</span>
                </div>
                <div class="cube-face back"></div>
                <div class="cube-face left"></div>
                <div class="cube-face right"></div>
                <div class="cube-face top"></div>
                <div class="cube-face bottom"></div>
            </div>
        </div>
        <div class="cube-container color-4" id="seesp-cube">
            <div class="cube">
                <div class="cube-face front">
                    <span class="name">SEESP</span>
                    <span id="seesp-desktop">Desktop: Carregando...</span>
                    <span id="seesp-notebook">Notebook: Carregando...</span>
                    <span id="seesp-monitor">Monitor: Carregando...</span>
                </div>
                <div class="cube-face back"></div>
                <div class="cube-face left"></div>
                <div class="cube-face right"></div>
                <div class="cube-face top"></div>
                <div class="cube-face bottom"></div>
            </div>
        </div>
        <div class="cube-container color-5" id="segov-cube">
            <div class="cube">
                <div class="cube-face front">
                    <span class="name">SEGOV</span>
                    <span id="segov-desktop">Desktop: Carregando...</span>
                    <span id="segov-notebook">Notebook: Carregando...</span>
                    <span id="segov-monitor">Monitor: Carregando...</span>
                </div>
                <div class="cube-face back"></div>
                <div class="cube-face left"></div>
                <div class="cube-face right"></div>
                <div class="cube-face top"></div>
                <div class="cube-face bottom"></div>
            </div>
        </div>
        <div class="cube-container color-1" id="seplan-cube">
            <div class="cube">
                <div class="cube-face front">
                    <span class="name">SEPLAN</span>
                    <span id="seplan-desktop">Desktop: Carregando...</span>
                    <span id="seplan-notebook">Notebook: Carregando...</span>
                    <span id="seplan-monitor">Monitor: Carregando...</span>
                </div>
                <div class="cube-face back"></div>
                <div class="cube-face left"></div>
                <div class="cube-face right"></div>
                <div class="cube-face top"></div>
                <div class="cube-face bottom"></div>
            </div>
        </div>
        <div class="cube-container color-2" id="sehab-cube">
            <div class="cube">
                <div class="cube-face front">
                    <span class="name">SEHAB</span>
                    <span id="sehab-desktop">Desktop: Carregando...</span>
                    <span id="sehab-notebook">Notebook: Carregando...</span>
                    <span id="sehab-monitor">Monitor: Carregando...</span>
                </div>
                <div class="cube-face back"></div>
                <div class="cube-face left"></div>
                <div class="cube-face right"></div>
                <div class="cube-face top"></div>
                <div class="cube-face bottom"></div>
            </div>
        </div>
    </div>

    <script>
        const spreadsheetId = '1GQMsTsJ88XeW5HnqF_CLHlIq-jyPlg5kBqRpjwHoWY4';
        const sheetName = 'INSTALADOS';

        async function fetchCell(sheetId, sheetName, cell, elementId) {
            try {
                const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?sheet=${encodeURIComponent(sheetName)}&range=${cell}`;
                const response = await fetch(url);
                if (!response.ok) throw new Error('Erro na requisição');
                const text = await response.text();
                const json = JSON.parse(text.substr(47).slice(0, -2));
                return json.table.rows[0]?.c[0]?.v || '--';
            } catch (error) {
                console.error(`Erro ao buscar ${cell} para ${elementId}:`, error);
                document.getElementById(elementId).classList.add('loading');
                return ''; // Retorna vazio para exibir a animação de pontinhos
            }
        }

        async function updateCubeData(secretaria, row) {
            const [desktop, notebook, monitor] = await Promise.all([
                fetchCell(spreadsheetId, sheetName, `L${row}`, `${secretaria}-desktop`),
                fetchCell(spreadsheetId, sheetName, `M${row}`, `${secretaria}-notebook`),
                fetchCell(spreadsheetId, sheetName, `N${row}`, `${secretaria}-monitor`)
            ]);
            document.getElementById(`${secretaria}-desktop`).textContent = `Desktop: ${desktop || '...'}`;
            document.getElementById(`${secretaria}-notebook`).textContent = `Notebook: ${notebook || '...'}`;
            document.getElementById(`${secretaria}-monitor`).textContent = `Monitor: ${monitor || '...'}`;
        }

        async function updateAllData() {
            const secretarias = [
                { name: 'sedes', row: 3 },
                { name: 'sesau', row: 4 },
                { name: 'sefaz', row: 5 },
                { name: 'seduc', row: 6 },
                { name: 'seo', row: 7 },
                { name: 'sajur', row: 8 },
                { name: 'secad', row: 9 },
                { name: 'segur', row: 10 },
                { name: 'setur', row: 11 },
                { name: 'sesep', row: 12 },
                { name: 'semam', row: 13 },
                { name: 'seurb', row: 14 },
                { name: 'sepedi', row: 15 },
                { name: 'seesp', row: 16 },
                { name: 'segov', row: 17 },
                { name: 'seplan', row: 18 },
                { name: 'sehab', row: 19 }
            ];

            await Promise.all(secretarias.map(({ name, row }) => updateCubeData(name, row)));
        }

        window.addEventListener('load', updateAllData);
        setInterval(updateAllData, 30000); // Atualiza a cada 30 segundos
    </script>
</body>
</html>
